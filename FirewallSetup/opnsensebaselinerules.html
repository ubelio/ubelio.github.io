<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>OPNsense Firewall Baseline Rules (Trusted VLANs)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="../style.css">
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #C9C8BF;
      color: #141413;
      margin: 0;
    }
    header {
      background-color: #141413;
      color: #C9C8BF;
      padding: 30px 20px;
      text-align: center;
    }
    nav {
      background-color: #AFACA1;
      padding: 10px;
      text-align: center;
    }
    nav a {
      color: #141413;
      margin: 0 15px;
      text-decoration: none;
      font-weight: bold;
    }
    nav a:hover {
      text-decoration: underline;
    }
    nav a.active {
      text-decoration: underline;
      color: #0073e6;
    }
    .container {
      max-width: 900px;
      margin: auto;
      padding: 20px;
    }
    h1, h2 {
      color: #141413;
    }
    ul, ol {
      padding-left: 20px;
    }
    figure {
      margin: 24px 0;
      padding: 12px;
      background-color: #E6E5DE;
      border: 1px solid #BDBBB2;
      border-radius: 8px;
    }
    .screenshot {
      display: block;
      max-width: 100%;
      width: 720px;
      height: auto;
      margin: 0 auto;
      border: 2px solid #141413;
      border-radius: 6px;
      box-shadow: 0 4px 14px rgba(0, 0, 0, 0.15);
    }
    figcaption.screenshot-note {
      text-align: center;
      font-style: italic;
      color: #555;
      margin-top: 10px;
    }
    footer {
      background-color: #BDBBB2;
      text-align: center;
      padding: 20px;
      font-size: 0.9em;
    }
    footer a {
      color: #141413;
      text-decoration: none;
    }
    footer a:hover {
      text-decoration: underline;
    }
    .section-divider {
      border: none;
      border-top: 1px solid #BDBBB2;
      margin: 32px 0;
    }
  </style>
</head>
<body>

<header>
  <h1>OPNsense Firewall Baseline Rules (Trusted VLANs)</h1>
  <p>Establish baseline allow/deny rules for trusted VLANs to enforce enterprise-style segmentation.</p>
</header>

<nav id="main-nav">
  <a href="/index.html">Home</a>
  <a href="/projects.html">Projects</a>
  <a href="/scripts.html">Scripts</a>
  <a href="/homelabconfig.html">Home-Lab Config</a>
  <a href="/labs.html">Labs</a>
  <a href="/contact.html">Contact</a>
</nav>

<script>
  const current = window.location.pathname.split("/").pop();
  document.querySelectorAll("#main-nav a").forEach(link => {
    if (link.getAttribute("href").endsWith(current)) {
      link.classList.add("active");
    }
  });
</script>

<div class="container">

  <h2>Tools Used</h2>
  <ul>
    <li>OPNsense Firewall</li>
    <li>Web GUI access</li>
    <li>Trusted VLAN configured from previous labs</li>
    <li>Client device for validation tests</li>
    <li>Browser + screenshot tool</li>
  </ul>

  <h2>Steps Taken</h2>
  <ol>
    <li>Opened <strong>Firewall → Rules → [Trusted VLAN]</strong>.</li>
    <li>Created allow rules for DNS (TCP/UDP 53), DHCP (UDP 67/68), and ICMP.</li>
    <li>Added an outbound allow rule to permit internet access.</li>
    <li>Added a final <strong>block-all</strong> rule with logging enabled.</li>
    <li>Applied changes and verified rule order.</li>
    <li>Validated DNS resolution, DHCP functionality, ping tests, and internet browsing.</li>
    <li>Generated intentional blocked traffic to confirm log visibility.</li>
  </ol>

  <hr class="section-divider">

  <h2>Screenshot: Firewall Rules (Trusted VLAN)</h2>
  <figure>
    <a href="fw-rules-trusted.png" target="_blank">
      <img src="fw-rules-trusted.png" alt="Firewall rules for trusted VLAN" class="screenshot">
    </a>
    <figcaption class="screenshot-note">Click to view full-size: Baseline allow/deny rules for the trusted VLAN.</figcaption>
  </figure>

  <h2>Screenshot: Firewall Logs (Blocked Traffic)</h2>
  <figure>
    <a href="fw-logs-blocked.png" target="_blank">
      <img src="fw-logs-blocked.png" alt="Firewall logs showing blocked traffic" class="screenshot">
    </a>
    <figcaption class="screenshot-note">Click to view full-size: Blocked inter-VLAN traffic logged by OPNsense.</figcaption>
  </figure>

  <h2>Screenshot: Ping Test</h2>
  <figure>
    <a href="ping-test.png" target="_blank">
      <img src="ping-test.png" alt="Ping test results" class="screenshot">
    </a>
    <figcaption class="screenshot-note">Click to view full-size: Successful ping to gateway and external IP.</figcaption>
  </figure>

  <h2>Screenshot: DNS Test</h2>
  <figure>
    <a href="dns-test.png" target="_blank">
      <img src="dns-test.png" alt="DNS resolution test" class="screenshot">
    </a>
    <figcaption class="screenshot-note">Click to view full-size: DNS resolution validated via nslookup or OPNsense diagnostics.</figcaption>
  </figure>

  <hr class="section-divider">

  <h2>Outcome</h2>
  <p>The trusted VLAN now enforces a clean, enterprise-style firewall baseline: essential services are allowed, outbound internet is permitted, and all other traffic is explicitly blocked and logged. Validation confirmed DNS, DHCP, ICMP, and internet access function correctly, while unauthorized traffic is denied and visible in the firewall logs. This establishes a secure foundation for further segmentation and policy development.</p>

</div>

<footer>
  <p>Email: <a href="mailto:ubelio@ubeliofernandez.com">ubelio@ubeliofernandez.com</a></p>
  <p>LinkedIn: <a href="https://www.linkedin.com/in/ubelio/" target="_blank">https://www.linkedin.com/in/ubelio/</a></p>
</footer>

</body>
</html>

